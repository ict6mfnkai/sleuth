<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Sleuth</title>
  <link rel="stylesheet" href="style.css">

  <!-- Firebase v8 SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script>
    // Replace with your Firebase config
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      projectId: "YOUR_PROJECT",
      storageBucket: "YOUR_PROJECT.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>
</head>
<body>
  <h1>🕵️ Sleuth</h1>
  <div id="game">
    <p id="question"></p>
    <img id="qImage" style="display:none;" />
    <div id="choices"></div>
    <p id="hint" style="color: gray;"></p>
    <p id="score">Score: 0</p>
    <p><a href="leaderboard.html">View Leaderboard</a></p>
  </div>

  <script>
    const QUESTIONS = [
      { text: "What does MIL stand for?", choices: ["Media and Information Literacy", "Modern Internet Learning", "Media in Libraries", "Machine Intelligence Logic"], correct: 0, hint: "It's about media and information skills." },
      { text: "Which of these is a reliable source?", choices: ["Peer-reviewed journal", "Random Facebook post", "Unverified blog", "Gossip"], correct: 0, hint: "Think academic." },
      { text: "What is 'fake news'?", choices: ["False or misleading information", "News on TV", "Ads", "Cartoons"], correct: 0, hint: "It spreads misinformation." },
      { text: "Which symbol represents 'Wi-Fi'?", choices: ["📶", "📞", "📺", "💡"], correct: 0, hint: "It looks like waves." },
      { text: "Who should you credit when using online images?", choices: ["The original creator", "Yourself", "Nobody", "A random site"], correct: 0, hint: "Respect copyright." },
      { text: "Which file format is commonly used for images?", choices: ["JPEG", "DOCX", "MP3", "TXT"], correct: 0, hint: "Think photos." },
      { text: "Which is NOT a social media platform?", choices: ["Google Docs", "Facebook", "Twitter", "Instagram"], correct: 0, hint: "One is for documents." },
      { text: "What does 'Ctrl + C' do?", choices: ["Copy", "Cut", "Paste", "Undo"], correct: 0, hint: "It duplicates text." },
      { text: "Which is an example of cyberbullying?", choices: ["Sending threats online", "Helping classmates", "Sharing notes", "Studying together"], correct: 0, hint: "It's harmful behavior." },
      { text: "What is plagiarism?", choices: ["Copying without credit", "Studying hard", "Writing essays", "Taking notes"], correct: 0, hint: "It's about stealing work." },
    ];

    let qEl = document.getElementById("question");
    let cEl = document.getElementById("choices");
    let hEl = document.getElementById("hint");
    let sEl = document.getElementById("score");
    let imgEl = document.getElementById("qImage");

    let current = 0;
    let score = 0;
    let selectedQuestions = [];

    function startGame() {
      let shuffled = QUESTIONS.sort(() => Math.random() - 0.5);
      selectedQuestions = shuffled.slice(0, 10);
      selectedQuestions.sort(() => Math.random() - 0.5);
      current = 0;
      score = 0;
      sEl.textContent = "Score: " + score;
      showQuestion();
    }

    function showQuestion() {
      let q = selectedQuestions[current];
      qEl.textContent = q.text;
      cEl.innerHTML = "";
      hEl.textContent = "";

      if (q.image) {
        imgEl.src = "images/" + q.image;
        imgEl.style.display = 'block';
      } else {
        imgEl.style.display = 'none';
      }

      let choices = q.choices.map((choice, index) => ({
        text: choice,
        isCorrect: index === q.correct
      }));
      choices.sort(() => Math.random() - 0.5);

      choices.forEach((ch) => {
        let btn = document.createElement("button");
        btn.textContent = ch.text;
        btn.onclick = () => selectAnswer(ch.isCorrect);
        cEl.appendChild(btn);
      });
    }

    function selectAnswer(isCorrect) {
      let q = selectedQuestions[current];
      if (isCorrect) {
        score++;
        sEl.textContent = "Score: " + score;
      } else {
        hEl.textContent = "Hint: " + q.hint;
      }
      current++;
      if (current < selectedQuestions.length) {
        showQuestion();
      } else {
        endGame();
      }
    }

    function endGame() {
      qEl.textContent = "Game Over! Final Score: " + score + "/10";
      cEl.innerHTML = "";
      imgEl.style.display = 'none';

      let againBtn = document.createElement("button");
      againBtn.textContent = "Play Again";
      againBtn.onclick = () => { startGame(); };
      cEl.appendChild(againBtn);

      let name = prompt("Enter your name for the leaderboard:");
      if (name) {
        db.collection("leaderboard").add({
          name: name,
          score: score,
          timestamp: firebase.firestore.FieldValue.serverTimestamp()
        });
      }
    }

    startGame();
  </script>
</body>
</html>
